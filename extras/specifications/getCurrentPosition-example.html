<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Current Location on Map</title>
<script>

// getCurrentPosition-example
//
// - An example code piece about the usage of getCurrentPosition in general
// 
// The getCurrentPosition method of the Geolocation API provides the current
// location of the browser in an asynchronous JavaScript call (most JavaScript
// is performed synchronously or in the main program flow).
// By having the API call as an asynchronous call, the query can be displayed
// to the user without blocking the processing of the rest of the page.
// The getCurrentPosition method retrieves the current position for the
// browser and takes one required parameter (a success callback function name)
// and 2 optional parameters (an error callback function and a position options object):
// 
// getCurrentPosition (successCallback [, errorCallback] [, positionOptions])
// 
// The parameters of the getCurrentPosition include the following:
// successCallback: The function to execute and pass the coordinates to
// errorCallback: (Optional) The function to handle any errors that occurred
// options: (Optional) An options object to handle how the position is retrieved
// 
// Since the call to getCurrentPosition is asynchronous, the method needs
// to be told which functions for success and potential failure will be
// executed when the method has completed.

// Initialize the page with other event listeners
function init() {
  var btnFindMe = document.getElementById('findMe');
  btnFindMe.addEventListener('click',findMe,false);
}

// success callback function for getCurrentPosition
function geoSuccess(position) {

  // grab the position DOMTimeStamp for display
  var dateDisplay = new Date(position.timestamp);

  // get reference to result div
  var myLocationDiv = document.getElementById('myLocation');

  // display the coords and timestamp object fields
  myLocationDiv.innerHTML = 'Lat: ' + position.coords.latitude + '<br>' +
    'Lng: ' + position.coords.longitude + '<br>' +
    'Accuracy: ' + position.coords.accuracy + '<br>' +
    'Altitude (opt): ' + position.coords.altitude + '<br>' +
    'Alt. Accuracy (opt): ' + position.coords.altitudeAccuracy + '<br>' +
    'Heading (opt): ' + position.coords.heading + '<br>' +
    'Speed (opt): ' + position.coords.speed + '<br>' +
    'Position DOMTimeStamp: ' + position.timestamp + '<br>' +
    'Time Date Stamp: ' + dateDisplay.toLocaleString();
}

// function called from button click to find position
function findMe() {
  var myLocationDiv = document.getElementById('myLocation');
  // check for geolocation support
  if (navigator.geolocation) {
    // make asynchronous getCurrentPosition call
    navigator.geolocation.getCurrentPosition(geoSuccess);
    myLocationDiv.innerHTML = 'Retrieving your location.';
  } else {
    // geolocation not supported
    myLocationDiv.innerHTML = 'Geolocation API Not Supported';
  }
}

// Initialize the page on load
window.addEventListener('load',init,false);

</script>
</head>
<body>
<div id='btnFindMe'>
  <button id="findMe">Find Me</button>
</div>
<div id="myLocation"></div>
</body>
</html>